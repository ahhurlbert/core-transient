---
title: "06_20_update"
author: "Molly Jenkins"
date: "June 20, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = "C:/git/core-transient")
library(raster)
library(rgdal)
library(dplyr)
library(tidyr)
library(ggplot2)
library(nlme)
library(gridExtra)
library(stats)

```


```{r, echo=FALSE}
env_hetero = read.csv("scripts/R-scripts/scale_analysis/env_hetero.csv", header = TRUE)
bbs_envs = read.csv("scripts/R-scripts/scale_analysis/bbs_envs.csv", header = TRUE)

#elev vs ndvi on plot - variance of quantile scores
q_scores = ggplot(env_hetero, aes(x = ndvi_qv, y = elev_qv))+geom_point()+theme_classic()+ggtitle("Variance of quantiles")
z_scores = ggplot(env_hetero, aes(x = ndvi_v, y = elev_v))+geom_point()+theme_classic()+ggtitle("Variance of z-scores")
#elev vs ndvi on plot - straight z scores, no var calc 
z_raw = ggplot(bbs_envs, aes(x=zndvi, y = zelev))+geom_point()+theme_classic()+ggtitle("Z scores of raw data")
qz = grid.arrange(q_scores, z_scores)
z_raw 

```

Looking at the values for the different coefficients versus the variance in the environmental variables

We expected high heterogeneity/high variance/high convex polygon volume to correspond to lower occupancy averages, characterized by high inflexion point values (inflexion point i occurs further along x axis) and lower asymptote values (asymptote A plateaus out at a lower y value due to the occupancy average being pulled down by a higher occurence of transients). 

We expected low heterogeneity/low variance/low convex polygon volume to correspond to higher occupancy averages, characterized by low inflexion point values (inflexion point i occurs early along x axis) and higher asymptote values (asymptote A plataeus out closer to maximum occupancy).

This would look like: points with high variance (high variance in elev/NDVI, high polygon volume would have high i values (low occ values)
AND 
points with low variance and volume would have low i values (high occupancy). This would be a positive linear relationship.  

The inverse being true for A values: high variance and volume would correspond to low A values (low occupancy) and low variance and volume would correspond to high A values. This would be a negative linear relationship. 

Instead, I got the following: 

```{r, echo = FALSE}
env_coefs = read.csv("scripts/R-scripts/scale_analysis/env_coefs.csv", header = TRUE) #just joined coefs to env_hetero file 
p1A = ggplot(data = env_coefs, aes(OA.A, elev_qv))+geom_point()
p2A = ggplot(data = env_coefs, aes(OA.A, ndvi_qv))+geom_point()
p3A = ggplot(data = env_coefs, aes(OA.A, qhull_vol))+geom_point()
p4A = ggplot(data = env_coefs, aes(OA.A, zhull_vol))+geom_point()
p5_1 = gridExtra::grid.arrange(p1A, p2A, p3A, p4A)

p1B = ggplot(data = env_coefs, aes(OA.i, elev_qv))+geom_point()
p2B = ggplot(data = env_coefs, aes(OA.i, ndvi_qv))+geom_point()
p3B = ggplot(data = env_coefs, aes(OA.i, qhull_vol))+geom_point()
p4B = ggplot(data = env_coefs, aes(OA.i, zhull_vol))+geom_point()
p5_2 = gridExtra::grid.arrange(p1B, p2B, p3B, p4B)

```

Additionally, when I look at the maxiumum values for my A and i points, I get the following: 

```{r}
max(env_coefs$OA.A, na.rm = T) #7
max(env_coefs$OA.i, na.rm = T) #8
```

^ the coefficients are calculated using a trycatch system in "alt_occ_scale.R" lines 167-329, including all files necessary to extract coefs. 